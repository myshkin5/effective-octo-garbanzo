[![Go Report Card](https://goreportcard.com/badge/myshkin5/effective-octo-garbanzo)](https://goreportcard.com/report/myshkin5/effective-octo-garbanzo)

# effective-octo-garbanzo

This is an opinionated* reference implementation of a Go microservice. It is not intended to be used as production code but it is written with the (opinionated*) standards of production code.

Whenever possible, idiomatic Go is used with as few dependencies (opinionated*) as possible. Go's idiom of using very short variable names is not followed much. I mostly agree with this idiom but when introducing a new language, I feel verbosity is best.

\* If you have a different opinion that you think would make this implementation better, file an issue or send me a pull request.

## What does it do?

`effective-octo-garbanzo` is a microservice that sits on its own Postgres relational database. The name was autogenerated by GitHub's new repository form. Per the name, the service serves _Octos_ and _Garbanzos_ in a parent/child relationship. _Octos_ have a `name` attribute which must be unique (the name is included in the resource URI). _Garbanzos_ have a `type` attribute (valid types are `DESI` and `KABULI`) and a `diameter-mm` attribute which must be a positive decimal number.

The database schema is [migrated](https://github.com/mattes/migrate) on startup from a [self-contained schema](./persistence/ddl/001_initial.up.sql). Note that multiple migrations are supported but since this is reference implementation, only one migration will ever be included here.

## Running the tests

There are several dependencies that need to be installed prior to running the tests:

* `goimports` `go get golang.org/x/tools/cmd/goimports`
* `ginkgo` `go get github.com/onsi/ginkgo/ginkgo`
* `docker-compose` https://docs.docker.com/compose/install/
* Docker https://docs.docker.com/engine/installation/

There are several Go dependencies that are vendored as git submodules. Run the following after cloning the repository and after each pull:

```bash
git submodule update --init --recursive
```

Finally to actually run the tests:

```bash
./scripts/test
```
## Running the code

Either by running the tests or by running the following script, a docker image is created:

```bash
./scripts/build
```
